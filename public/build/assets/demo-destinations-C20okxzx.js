import{j as e,A as y,m as h}from"./framer-motion-B-VyjaWK.js";import{d as S,r as n,a as E,b as L,H as T}from"./inertia-DnB9r-Z9.js";import{u as U}from"./GlobalHeader-l0kzleMn.js";import{g as P}from"./imageHelper-DKYo5vcR.js";import{E as c}from"./EditableText-DoOsPgQ_.js";import{P as I}from"./public-layout-JhTyfVOV.js";import"./vendor-DP3lGzMr.js";import"./logout-ChJA0uHM.js";import"./radix-ui-BGF_4iPy.js";import"./lucide-BFbptF3M.js";import"./EditToggleButton-DeEORzR9.js";function M({sectionKey:o,src:s,alt:v,className:j,imgClassName:N}){const{isAdmin:l,editMode:m,markDirty:u}=U(),{props:D}=S(),g=D.sections?.[o]?.image,[k,d]=n.useState(void 0),[w,x]=n.useState(!1),f=n.useRef(null),b=t=>t?t.startsWith("http://")||t.startsWith("https://")?t:P(t):"",R=k??(g?b(g):s?b(s):""),p=n.useCallback(async t=>{const a=URL.createObjectURL(t);d(a),u();const i=new FormData;i.append("key",o),i.append("image",t);try{await E.post("/admin/upload-image",i,{headers:{"Content-Type":"multipart/form-data"}}),x(!0),setTimeout(()=>x(!1),900),URL.revokeObjectURL(a),d(void 0),L.reload({only:["sections"],onSuccess:()=>{console.log("✅ Image reloaded from database:",o)}})}catch(r){console.error("Failed to upload image:",r),URL.revokeObjectURL(a),d(void 0)}},[o,u]),C=n.useCallback(t=>{const a=t.target.files?.[0];a&&p(a)},[p]);return e.jsxs("div",{className:`group relative ${j??""}`,onDragOver:t=>m&&l?(t.preventDefault(),t.dataTransfer.dropEffect="copy"):void 0,onDrop:t=>{if(!(m&&l))return;t.preventDefault();const a=t.dataTransfer.files?.[0];a&&p(a)},children:[e.jsx("img",{src:R,alt:v,className:N,onError:t=>{const a=t.currentTarget;if(a.src&&a.src.includes("assets.cahayaanbiya.com")){const i=a.src;let r=i;i.includes("/public/images/")?r=i.replace("/public/images/","/images/"):i.includes("/public/")?r=i.replace("/public/","/"):i.includes("/images/")?r=i.replace("/images/","/public/images/"):r=`https://assets.cahayaanbiya.com/public/images/${i.split("/").pop()||s||""}`,console.log("[EditableImage] Trying alternative R2 path:",r),a.src=r}}}),e.jsx(y,{children:l&&m&&e.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 grid place-items-center rounded-md bg-black/30 ring-2 ring-blue-400/50",onClick:()=>f.current?.click(),children:[e.jsx("span",{className:"rounded bg-white/90 px-3 py-1 text-xs font-medium text-gray-800",children:"Drag & Drop image or Click to replace"}),e.jsx("input",{ref:f,type:"file",accept:"image/png,image/jpeg",className:"hidden",onChange:C})]})}),e.jsx(y,{children:w&&e.jsx(h.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"absolute -bottom-6 left-0 z-50 rounded bg-black/80 px-2 py-1 text-xs text-emerald-300",children:"Image saved ✓"})})]})}function J(){const o=[{id:1,name:"Arab Saudi",description:"Spiritual journey to the Holy Land",image:"/arabsaudi.jpg"},{id:2,name:"Dubai",description:"Modern wonders & desert adventures",image:"/dubai1.jpeg"}];return e.jsxs(I,{children:[e.jsx(T,{title:"CMS Demo Destinations"}),e.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-10",children:[e.jsx(c,{sectionKey:"cms.demo.title",value:"CMS Demo Destinations",tag:"h1",className:"text-3xl font-bold"}),e.jsx("p",{className:"mt-2 text-gray-500",children:e.jsx(c,{sectionKey:"cms.demo.subtitle",value:"Try editing texts and replacing images inline. Only admins see the controls.",tag:"span"})}),e.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2",children:o.map(s=>e.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/50",children:[e.jsx(M,{sectionKey:`cms.demo.dest.${s.id}.image`,src:s.image,alt:s.name,imgClassName:"h-56 w-full object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx(c,{sectionKey:`cms.demo.dest.${s.id}.name`,value:s.name,tag:"h3",className:"text-lg font-semibold text-white"}),e.jsx(c,{sectionKey:`cms.demo.dest.${s.id}.desc`,value:s.description,tag:"p",className:"mt-1 text-sm text-gray-300"})]})]},s.id))})]})]})}export{J as default};
