import{j as a,A as R,m as E}from"./framer-motion-D9Ds6MjR.js";import{u as K,r as o,a as W,b as z,H as B}from"./inertia-D2QVZ4Tm.js";import{n as G,j as _,I as q,h as J,P as Q,E as m}from"./app-DSi8VVF8.js";import"./vendor-DP3lGzMr.js";/* empty css            */import"./radix-ui-D0Dk_8AA.js";import"./lucide-BqQJBEkW.js";function V({sectionKey:l,src:i,alt:I,className:U,imgClassName:L,aspect:O=16/9}){const{isAdmin:p,editMode:u,markDirty:f}=G(),{props:x}=K(),y=x.cmsMediaGuide?.images??{},h=x.sections?.[l]?.image,[M,A]=o.useState(void 0),[F,j]=o.useState(!1),[T,d]=o.useState(!1),[r,g]=o.useState(null),v=o.useRef(null),C=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:J(e):"",P=M??(h?C(h):i?C(i):""),k=o.useCallback(async e=>{const t=new File([e],"image.jpg",{type:e.type}),s=await _(t),n=new FormData;n.append("key",l),n.append("image",s),await W.post("/admin/upload-image",n,{headers:{Accept:"application/json"}}),j(!0),setTimeout(()=>j(!1),900),A(void 0),z.reload({only:["sections"],onSuccess:()=>{console.log("✅ Image reloaded from database:",l)}})},[l]),N=o.useCallback(e=>{const t=URL.createObjectURL(e);g(t),d(!0),f()},[f]),$=o.useCallback(async e=>{if(!r)return;const t=r;try{await k(e),URL.revokeObjectURL(t),g(null),d(!1)}catch(s){console.error("Failed to upload image:",s);const c=(s&&typeof s=="object"&&"response"in s?s:null)?.response?.data;let S=c?.message||(s instanceof Error?s.message:"Failed to upload image");if(c?.errors&&typeof c.errors=="object"){const D=Object.values(c.errors).flat().filter(Boolean);D.length&&(S=D.join(". "))}alert(S)}},[r,k]),w=o.useCallback(()=>{r&&(URL.revokeObjectURL(r),g(null)),d(!1)},[r]);o.useEffect(()=>()=>{r&&URL.revokeObjectURL(r)},[r]);const b=o.useCallback(e=>{e.type.startsWith("image/")&&N(e)},[N]),H=o.useCallback(e=>{const t=e.target.files?.[0];t&&b(t),e.target.value=""},[b]);return a.jsxs("div",{className:`group relative ${U??""}`,onDragOver:e=>u&&p?(e.preventDefault(),e.dataTransfer.dropEffect="copy"):void 0,onDrop:e=>{if(!(u&&p))return;e.preventDefault();const t=e.dataTransfer.files?.[0];t&&b(t)},children:[a.jsx("img",{src:P,alt:I,className:L,onError:e=>{const t=e.currentTarget;if(t.src&&t.src.includes("assets.cahayaanbiya.com")){const s=t.src;let n=s;s.includes("/public/images/")?n=s.replace("/public/images/","/images/"):s.includes("/public/")?n=s.replace("/public/","/"):s.includes("/images/")?n=s.replace("/images/","/public/images/"):n=`https://assets.cahayaanbiya.com/public/images/${s.split("/").pop()||i||""}`,console.log("[EditableImage] Trying alternative R2 path:",n),t.src=n}}}),a.jsx(R,{children:p&&u&&a.jsxs(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-[9999] flex flex-col items-center justify-center gap-3 rounded-md bg-black/70 backdrop-blur-md",onClick:()=>v.current?.click(),style:{pointerEvents:"auto"},children:[a.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-xl border-2 border-blue-400/50 bg-black/90 p-6 shadow-2xl backdrop-blur-sm",children:[a.jsx("span",{className:"rounded-lg bg-white px-5 py-2.5 text-sm font-bold text-gray-900 shadow-lg",children:"Drag & Drop atau Klik untuk ganti gambar"}),a.jsx("span",{className:"text-xs text-neutral-300",children:"Anda bisa atur posisi gambar sebelum disimpan"}),y.short&&a.jsx("span",{className:"rounded-lg border-2 border-amber-400 bg-gradient-to-r from-amber-900 to-orange-900 px-5 py-2.5 text-xs font-bold text-amber-50 shadow-lg",children:y.short})]}),a.jsx("input",{ref:v,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:H})]})}),a.jsx(R,{children:F&&a.jsx(E.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"absolute -bottom-6 left-0 z-50 rounded bg-black/80 px-2 py-1 text-xs text-emerald-300",children:"Image saved ✓"})}),r&&a.jsx(q,{open:T,onOpenChange:e=>{d(e),e||w()},imageSrc:r,aspect:O,onApply:$,onCancel:w})]})}function ie(){const l=[{id:1,name:"Arab Saudi",description:"Spiritual journey to the Holy Land",image:"/arabsaudi.jpg"},{id:2,name:"Dubai",description:"Modern wonders & desert adventures",image:"/dubai1.jpeg"}];return a.jsxs(Q,{children:[a.jsx(B,{title:"CMS Demo Destinations"}),a.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-10",children:[a.jsx(m,{sectionKey:"cms.demo.title",value:"CMS Demo Destinations",tag:"h1",className:"text-3xl font-bold"}),a.jsx("p",{className:"mt-2 text-gray-500",children:a.jsx(m,{sectionKey:"cms.demo.subtitle",value:"Try editing texts and replacing images inline. Only admins see the controls.",tag:"span"})}),a.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2",children:l.map(i=>a.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/50",children:[a.jsx(V,{sectionKey:`cms.demo.dest.${i.id}.image`,src:i.image,alt:i.name,imgClassName:"h-56 w-full object-cover"}),a.jsxs("div",{className:"p-4",children:[a.jsx(m,{sectionKey:`cms.demo.dest.${i.id}.name`,value:i.name,tag:"h3",className:"text-lg font-semibold text-white"}),a.jsx(m,{sectionKey:`cms.demo.dest.${i.id}.desc`,value:i.description,tag:"p",className:"mt-1 text-sm text-gray-300"})]})]},i.id))})]})]})}export{ie as default};
