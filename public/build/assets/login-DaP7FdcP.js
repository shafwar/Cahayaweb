import{j as e,r as c}from"./vendor-xbp5l6jL.js";import{a as O,r as S,H as D}from"./inertia-DHIGbZy3.js";import{L as w,I as k}from"./label-Df3YEJdH.js";import{T as E}from"./text-link-C9_GoetS.js";import{f as q,B as z}from"./app-DVZnqEQ_.js";import{c as A,d as K}from"./radix-ui-BoiiLyM6.js";import{N as M,K as T,O as X,E as H}from"./lucide-CqQBvqG2.js";import{I as C}from"./input-BE6THiDP.js";import{A as B}from"./auth-layout-wIfRvB1A.js";import"./vendor-other-Bed90F6z.js";import"./axios-C7aFLusC.js";/* empty css            */import"./framer-motion-BieQRSTL.js";function $({className:u,...h}){return e.jsx(A,{"data-slot":"checkbox",className:q("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",u),...h,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(M,{className:"size-3.5"})})})}function de({status:u,canResetPassword:h,mode:m,redirect:I,error:b}){const[x,L]=c.useState(!1),[J,v]=c.useState(!1),[r,a]=c.useState(!1),[g,l]=c.useState(!1),{data:o,setData:f,post:U,processing:t,errors:n,reset:j}=O({email:"",password:"",remember:!1,mode:typeof m=="string"?m:void 0,redirect:I??void 0});c.useEffect(()=>{a(t)},[t]),c.useEffect(()=>{const i=sessionStorage.getItem("login_pending_resubmit");if(i)try{const s=JSON.parse(i);l(!1),f({email:s.email||"",password:s.password||"",remember:s.remember||!1,mode:s.mode,redirect:s.redirect}),setTimeout(()=>{a(!0);const y="/login",d={email:s.email||"",password:s.password||"",remember:s.remember||!1,mode:s.mode,redirect:s.redirect},p=document.querySelector('meta[name="csrf-token"]')?.content;p&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=p),S.post(y,d,{preserveState:!0,preserveScroll:!1,onStart:()=>a(!0),onProgress:()=>a(!0),onFinish:()=>{a(!1),j("password"),l(!1),sessionStorage.removeItem("login_pending_resubmit")},onSuccess:()=>{sessionStorage.removeItem("login_pending_resubmit"),l(!1)},onError:()=>{setTimeout(()=>a(!1),150),l(!0),sessionStorage.removeItem("login_pending_resubmit")}}).catch(()=>{l(!0),setTimeout(()=>a(!1),400),sessionStorage.removeItem("login_pending_resubmit")})},300)}catch{sessionStorage.removeItem("login_pending_resubmit")}},[]),c.useEffect(()=>{(n.email||n.password)&&l(!0)},[n.email,n.password]);const _=i=>{f("email",i.target.value)},P=i=>{f("password",i.target.value)};c.useEffect(()=>{const i=document.querySelector('meta[name="csrf-token"]');i&&i.content?(typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=i.content),v(!0)):fetch("/sanctum/csrf-cookie",{method:"HEAD",credentials:"include",cache:"no-store"}).then(()=>{setTimeout(()=>{const s=document.querySelector('meta[name="csrf-token"]');s&&s.content&&(typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=s.content),v(!0))},100)}).catch(s=>{})},[]);const R=i=>{if(i.preventDefault(),t||r)return;if(g){const d={email:o.email,password:o.password,remember:o.remember,mode:o.mode,redirect:o.redirect};sessionStorage.setItem("login_pending_resubmit",JSON.stringify(d)),a(!0),setTimeout(()=>{window.location.reload()},100);return}const s=document.querySelector('meta[name="csrf-token"]')?.content;if(!s)return;s&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=s),a(!0),S.post("/login",o,{preserveState:!0,preserveScroll:!1,forceFormData:!1,onStart:()=>{a(!0)},onProgress:()=>{a(!0)},onFinish:()=>{a(!1),j("password")},onSuccess:d=>{sessionStorage.removeItem("login_pending_resubmit"),l(!1)},onError:d=>{setTimeout(()=>a(!1),150),l(!0);const p=d?.message||(typeof d=="string"?d:"")||"",F=JSON.stringify(d||{});if(/419|expired|PAGE EXPIRED|csrf|token/i.test(p)||/419|expired|csrf|token/i.test(F)){setTimeout(()=>window.location.reload(),400);return}const N=document.querySelector('meta[name="csrf-token"]')?.content;N&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=N.content)}}).catch(d=>{l(!0),setTimeout(()=>a(!1),400)})};return e.jsxs(B,{title:m==="admin"?"Admin Login":"Log in to your account",description:m==="admin"?"Enter your admin credentials to access the admin dashboard":"Enter your email and password below to log in",children:[e.jsx(D,{title:m==="admin"?"Admin Login":"Log in"}),b&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsx("p",{className:"text-sm text-red-300",children:b})}),e.jsxs("form",{method:"POST",className:"flex flex-col gap-6 relative",onSubmit:R,children:[(t||r)&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 rounded-xl bg-gray-900/98 px-8 py-6 shadow-2xl border border-amber-500/20",children:[e.jsx(T,{className:"h-10 w-10 animate-spin text-amber-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-base font-semibold text-white",children:g?"Refreshing page...":"Validating credentials..."}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:g?"Please wait while we refresh and validate your credentials":"Please wait while we verify your information"})]}),e.jsx("div",{className:"w-48 h-1 bg-gray-700 rounded-full overflow-hidden mt-2",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-orange-500 animate-pulse",style:{width:"60%"}})})]})}),o.mode&&e.jsx("input",{type:"hidden",name:"mode",value:o.mode}),o.redirect&&e.jsx("input",{type:"hidden",name:"redirect",value:o.redirect}),e.jsxs("div",{className:`grid gap-6 transition-opacity duration-200 ${t||r?"opacity-50 pointer-events-none":"opacity-100"}`,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(w,{htmlFor:"email",children:"Email address"}),e.jsx(C,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",value:o.email,onChange:_,placeholder:"email@example.com",disabled:t||r,className:t||r?"opacity-60 cursor-not-allowed":""}),e.jsx(k,{message:n.email}),n.email&&e.jsx("div",{className:"mt-2 rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-300",children:n.email}),n.email.includes("Admin accounts cannot login")&&e.jsxs("p",{className:"mt-1 text-xs text-red-200",children:["Please use the admin login page directly at ",e.jsx("code",{className:"text-xs bg-red-500/20 px-1 py-0.5 rounded",children:"/admin"})]})]})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{htmlFor:"password",children:"Password"}),h&&e.jsx(E,{href:route("password.request"),className:"ml-auto text-sm",tabIndex:5,children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{id:"password",type:x?"text":"password",required:!0,tabIndex:2,autoComplete:"current-password",value:o.password,onChange:P,placeholder:"Password",className:`pr-10 ${t||r?"opacity-60 cursor-not-allowed":""}`,disabled:t||r}),e.jsx("button",{type:"button",onClick:()=>L(!x),disabled:t||r,className:`absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 focus:outline-none focus:text-gray-600 transition-colors ${t||r?"opacity-50 cursor-not-allowed":""}`,tabIndex:-1,"aria-label":x?"Hide password":"Show password",children:x?e.jsx(X,{className:"h-4 w-4"}):e.jsx(H,{className:"h-4 w-4"})})]}),e.jsx(k,{message:n.password}),n.password&&e.jsx("div",{className:"mt-2 rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm font-medium text-red-300",children:n.password})]})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{id:"remember",name:"remember",checked:o.remember,onClick:()=>f("remember",!o.remember),tabIndex:3,disabled:t||r,className:t||r?"opacity-60 cursor-not-allowed":""}),e.jsx(w,{htmlFor:"remember",className:t||r?"opacity-60 cursor-not-allowed":"",children:"Remember me"})]}),e.jsx(z,{type:"submit",className:"mt-4 w-full relative min-h-[44px]",tabIndex:4,disabled:t||r,children:t||r?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Validating credentials..."})]}):"Log in"})]}),m!=="admin"&&e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(E,{href:route("register"),tabIndex:5,children:"Sign up"})]})]}),u&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600",children:u})]})}export{de as default};
