import{r,j as a}from"./vendor-xbp5l6jL.js";import{a as H}from"./axios-C7aFLusC.js";import{u as W,r as z,H as B}from"./inertia-DHIGbZy3.js";import{m as G,i as _,I as q,g as J,P as Q,E as d}from"./app-DVZnqEQ_.js";import{A as R,m as E}from"./framer-motion-BieQRSTL.js";import"./vendor-other-Bed90F6z.js";/* empty css            */import"./radix-ui-BoiiLyM6.js";import"./lucide-CqQBvqG2.js";function V({sectionKey:l,src:i,alt:U,className:L,imgClassName:O,aspect:I=16/9}){const{isAdmin:p,editMode:u,markDirty:x}=G(),{props:b}=W(),y=b.cmsMediaGuide?.images??{},j=b.sections?.[l]?.image,[M,A]=r.useState(void 0),[F,h]=r.useState(!1),[P,m]=r.useState(!1),[o,g]=r.useState(null),v=r.useRef(null),C=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:J(e):"",T=M??(j?C(j):i?C(i):""),k=r.useCallback(async e=>{const t=new File([e],"image.jpg",{type:e.type}),s=await _(t),n=new FormData;n.append("key",l),n.append("image",s),await H.post("/admin/upload-image",n,{headers:{Accept:"application/json"}}),h(!0),setTimeout(()=>h(!1),900),A(void 0),z.reload({only:["sections"],onSuccess:()=>{}})},[l]),N=r.useCallback(e=>{const t=URL.createObjectURL(e);g(t),m(!0),x()},[x]),$=r.useCallback(async e=>{if(!o)return;const t=o;try{await k(e),URL.revokeObjectURL(t),g(null),m(!1)}catch(s){const c=(s&&typeof s=="object"&&"response"in s?s:null)?.response?.data;let S=c?.message||(s instanceof Error?s.message:"Failed to upload image");if(c?.errors&&typeof c.errors=="object"){const D=Object.values(c.errors).flat().filter(Boolean);D.length&&(S=D.join(". "))}alert(S)}},[o,k]),w=r.useCallback(()=>{o&&(URL.revokeObjectURL(o),g(null)),m(!1)},[o]);r.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const f=r.useCallback(e=>{e.type.startsWith("image/")&&N(e)},[N]),K=r.useCallback(e=>{const t=e.target.files?.[0];t&&f(t),e.target.value=""},[f]);return a.jsxs("div",{className:`group relative ${L??""}`,onDragOver:e=>u&&p?(e.preventDefault(),e.dataTransfer.dropEffect="copy"):void 0,onDrop:e=>{if(!(u&&p))return;e.preventDefault();const t=e.dataTransfer.files?.[0];t&&f(t)},children:[a.jsx("img",{src:T,alt:U,className:O,onError:e=>{const t=e.currentTarget;if(t.src&&t.src.includes("assets.cahayaanbiya.com")){const s=t.src;let n=s;s.includes("/public/images/")?n=s.replace("/public/images/","/images/"):s.includes("/public/")?n=s.replace("/public/","/"):s.includes("/images/")?n=s.replace("/images/","/public/images/"):n=`https://assets.cahayaanbiya.com/public/images/${s.split("/").pop()||i||""}`,t.src=n}}}),a.jsx(R,{children:p&&u&&a.jsxs(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-[9999] flex flex-col items-center justify-center gap-3 rounded-md bg-black/70 backdrop-blur-md",onClick:()=>v.current?.click(),style:{pointerEvents:"auto"},children:[a.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-xl border-2 border-blue-400/50 bg-black/90 p-6 shadow-2xl backdrop-blur-sm",children:[a.jsx("span",{className:"rounded-lg bg-white px-5 py-2.5 text-sm font-bold text-gray-900 shadow-lg",children:"Drag & Drop atau Klik untuk ganti gambar"}),a.jsx("span",{className:"text-xs text-neutral-300",children:"Anda bisa atur posisi gambar sebelum disimpan"}),y.short&&a.jsx("span",{className:"rounded-lg border-2 border-amber-400 bg-gradient-to-r from-amber-900 to-orange-900 px-5 py-2.5 text-xs font-bold text-amber-50 shadow-lg",children:y.short})]}),a.jsx("input",{ref:v,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:K})]})}),a.jsx(R,{children:F&&a.jsx(E.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"absolute -bottom-6 left-0 z-50 rounded bg-black/80 px-2 py-1 text-xs text-emerald-300",children:"Image saved âœ“"})}),o&&a.jsx(q,{open:P,onOpenChange:e=>{m(e),e||w()},imageSrc:o,aspect:I,onApply:$,onCancel:w})]})}function oe(){const l=[{id:1,name:"Arab Saudi",description:"Spiritual journey to the Holy Land",image:"/arabsaudi.jpg"},{id:2,name:"Dubai",description:"Modern wonders & desert adventures",image:"/dubai1.jpeg"}];return a.jsxs(Q,{children:[a.jsx(B,{title:"CMS Demo Destinations"}),a.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-10",children:[a.jsx(d,{sectionKey:"cms.demo.title",value:"CMS Demo Destinations",tag:"h1",className:"text-3xl font-bold"}),a.jsx("p",{className:"mt-2 text-gray-500",children:a.jsx(d,{sectionKey:"cms.demo.subtitle",value:"Try editing texts and replacing images inline. Only admins see the controls.",tag:"span"})}),a.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2",children:l.map(i=>a.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/50",children:[a.jsx(V,{sectionKey:`cms.demo.dest.${i.id}.image`,src:i.image,alt:i.name,imgClassName:"h-56 w-full object-cover"}),a.jsxs("div",{className:"p-4",children:[a.jsx(d,{sectionKey:`cms.demo.dest.${i.id}.name`,value:i.name,tag:"h3",className:"text-lg font-semibold text-white"}),a.jsx(d,{sectionKey:`cms.demo.dest.${i.id}.desc`,value:i.description,tag:"p",className:"mt-1 text-sm text-gray-300"})]})]},i.id))})]})]})}export{oe as default};
