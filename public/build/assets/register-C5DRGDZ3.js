import{j as e}from"./framer-motion-D9Ds6MjR.js";import{u as T,r as R,d as q,H as A}from"./inertia-D2QVZ4Tm.js";import{L as g,I as f}from"./label-Bu73W4bc.js";import{T as I}from"./text-link-u4L8GLSd.js";import{B}from"./button-EzLD4ntO.js";import{I as w}from"./input-DtVwymUo.js";import{A as O}from"./auth-layout-BRDuB3cb.js";import{Q as z}from"./lucide-CmpPQWiQ.js";import"./vendor-DP3lGzMr.js";import"./app-DFHYiAgk.js";/* empty css            */import"./radix-ui-CoelwvIk.js";function Z(){const{url:m,props:E}=T(),j=E?.status,[y,v]=R.useState(!1),{data:s,setData:c,post:F,processing:N,errors:r,reset:k}=q({name:"",email:"",password:"",password_confirmation:"",mode:"",redirect:""});R.useEffect(()=>{const t=new URLSearchParams(typeof window<"u"?window.location.search:m.split("?")[1]||""),p=t.get("mode"),o=t.get("redirect");(p||o)&&c(u=>({...u,...p?{mode:p}:{},...o?{redirect:o}:{}}))},[m]);const b=new URLSearchParams(m.split("?")[1]||"").get("mode"),S=new URLSearchParams(m.split("?")[1]||"").get("redirect"),L=t=>{if(t.preventDefault(),N||y)return;v(!0);let o=document.querySelector('meta[name="csrf-token"]')?.content;if(!o&&typeof document<"u"){const a=document.cookie.split("; ").find(d=>d.startsWith("XSRF-TOKEN="));a&&(o=decodeURIComponent(a.split("=")[1]))}o&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=o);const u=new URLSearchParams(typeof window<"u"?window.location.search:""),U=u.get("mode"),_=u.get("redirect"),P=s.mode||U,C=s.redirect||_;let h=route("register");const x=new URLSearchParams;if(P&&x.set("mode",P),C&&x.set("redirect",C),x.toString()&&(h+="?"+x.toString()),typeof window<"u"&&window.location.protocol==="https:"){const a=new URL(h,window.location.origin);a.protocol==="http:"&&(a.protocol="https:",h=a.toString())}F(h,{preserveState:!1,preserveScroll:!1,only:[],transform:a=>{const d=new URLSearchParams(typeof window<"u"?window.location.search:""),n=d.get("mode"),l=d.get("redirect");return{...a,...n?{mode:n}:{},...l?{redirect:l}:{}}},onError:a=>{console.error("Registration errors:",a);const d=a?.message||(typeof a=="string"?a:"");if(d.includes("419")||d.includes("expired")||d.includes("PAGE EXPIRED")){alert("Your session has expired. Please refresh the page and try again."),window.location.reload();return}const n=Object.keys(a)[0];if(n){const l=document.getElementById(n)||document.querySelector(`[name="${n}"]`);l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),l.focus())}},onFinish:()=>{v(!1),k("password","password_confirmation")}})},i=y||N;return e.jsxs(O,{title:"Create an account",description:"Enter your details below to create your account",children:[e.jsx(A,{title:"Register"}),j&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-500/30 bg-green-500/10 p-3",children:e.jsx("p",{className:"text-sm text-green-300",children:j})}),b==="b2b"&&e.jsx("div",{className:"mb-4 rounded-lg border border-blue-500/30 bg-blue-500/10 p-3",children:e.jsx("p",{className:"text-sm text-blue-200",children:"After creating your account you will be redirected to the verification page to complete your B2B application."})}),e.jsxs("form",{method:"POST",className:"flex flex-col gap-6",onSubmit:L,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"name",children:"Name"}),e.jsx(w,{id:"name",type:"text",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"name",value:s.name,onChange:t=>c("name",t.target.value),disabled:i,placeholder:"Full name"}),e.jsx(f,{message:r.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"email",children:"Email address"}),e.jsx(w,{id:"email",type:"email",required:!0,tabIndex:2,autoComplete:"email",value:s.email,onChange:t=>c("email",t.target.value),disabled:i,placeholder:"email@example.com",className:r.email&&r.email.includes("already registered")?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),e.jsx(f,{message:r.email}),r.email&&(r.email.includes("already registered")||r.email.includes("already been taken")||r.email.includes("unique"))&&e.jsx("div",{className:"mt-2 rounded-lg border-2 border-amber-500/50 bg-amber-500/20 p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"mb-1 text-sm font-semibold text-amber-300",children:"Email Already Registered"}),e.jsxs("p",{className:"text-sm leading-relaxed text-amber-200/90",children:["The email address ",e.jsx("strong",{className:"font-semibold text-amber-100",children:s.email})," is already registered in our system."]}),e.jsxs("p",{className:"mt-2 text-sm text-amber-200/90",children:["If this is your account, please"," ",e.jsx(I,{href:route("login",b==="b2b"?{mode:"b2b",redirect:S}:{}),className:"font-semibold text-amber-100 underline hover:text-amber-50",children:"log in here"})," ","instead. If you forgot your password, you can reset it from the login page."]})]})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"password",children:"Password"}),e.jsx(w,{id:"password",type:"password",required:!0,tabIndex:3,autoComplete:"new-password",value:s.password,onChange:t=>c("password",t.target.value),disabled:i,placeholder:"Password (minimum 8 characters)",minLength:8}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{message:r.password}),!r.password&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters long."})]}),s.password&&s.password.length>0&&s.password.length<8&&e.jsx("div",{className:"mt-1 rounded-lg border border-amber-500/30 bg-amber-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-amber-300",children:[e.jsx("strong",{children:"Password too short:"})," Your password must be at least 8 characters. Currently:"," ",s.password.length," character",s.password.length!==1?"s":"","."]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(w,{id:"password_confirmation",type:"password",required:!0,tabIndex:4,autoComplete:"new-password",value:s.password_confirmation,onChange:t=>c("password_confirmation",t.target.value),disabled:i,placeholder:"Confirm password"}),e.jsx(f,{message:r.password_confirmation}),s.password&&s.password_confirmation&&s.password!==s.password_confirmation&&e.jsx("div",{className:"mt-1 rounded-lg border border-red-500/30 bg-red-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-red-300",children:[e.jsx("strong",{children:"Passwords do not match."})," Please make sure both password fields contain the same password."]})})]}),e.jsx(B,{type:"submit",className:"mt-2 w-full",tabIndex:5,disabled:i,"aria-busy":i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 shrink-0 animate-spin","aria-hidden":!0}),"Creating account..."]}):"Create account"})]}),r&&Object.keys(r).length>0&&!r.name&&!r.email&&!r.password&&!r.password_confirmation&&e.jsx("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsx("p",{className:"text-sm text-red-300",children:"Please check the form for errors and try again."})}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(I,{href:route("login",b==="b2b"?{mode:"b2b",redirect:S}:{}),tabIndex:6,children:"Log in"})]})]})]})}export{Z as default};
