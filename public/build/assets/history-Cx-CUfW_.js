import{j as e,A as F,m as w}from"./app-CA3mLSp7.js";import{r as n,H as L,a as k}from"./inertia-DFKzB8kt.js";import{P as E}from"./public-layout-uXVT9vqr.js";import{A as P}from"./arrow-left-CzMZsqlR.js";import{c as u}from"./createLucideIcon-CRj4IT6D.js";import{S as U,C as I,R as C}from"./GlobalHeader-BDXJg3NR.js";import{T as _,I as S,C as z}from"./type-cpDYRzQO.js";import{C as B}from"./chevron-up-CaCY2wMz.js";/* empty css            */import"./vendor-DP3lGzMr.js";import"./x-C7Koiijf.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],D=u("Filter",q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],p=u("History",O);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],V=u("User",Q);function re({sections:x}){const[i,R]=n.useState(""),[l,m]=n.useState("all"),[T,H]=n.useState(new Set),[y,g]=n.useState(null),h=s=>{const a=s.split("."),t=a[0]||"Unknown",o=a[1]||"",c=a[2]||"",d=a[3]||a[2]||"";return{page:t.charAt(0).toUpperCase()+t.slice(1),section:o.replace(/([A-Z])/g," $1").trim(),id:c,field:d.charAt(0).toUpperCase()+d.slice(1),fullPath:s}},f=n.useMemo(()=>x.filter(s=>{if(i){const a=i.toLowerCase(),{page:t,section:o,field:c}=h(s.key);if(!`${t} ${o} ${c} ${s.key}`.toLowerCase().includes(a))return!1}return!(l!=="all"&&(!(s.revisions.length>0)||l==="text"&&!s.current_content||l==="image"&&!s.current_image))}),[x,i,l]),b=n.useMemo(()=>{const s={};return f.forEach(a=>{const{page:t}=h(a.key);s[t]||(s[t]=[]),s[t].push(a)}),s},[f]),A=s=>{H(a=>{const t=new Set(a);return t.has(s)?t.delete(s):t.add(s),t})},M=async(s,a)=>{if(confirm(`Are you sure you want to restore to this version?

This will replace the current content with the selected revision.`)){g(a);try{await k.post("/admin/history/restore",{key:s,revision_id:a},{preserveState:!1,onSuccess:()=>{const t=document.createElement("div");t.className="fixed top-20 right-4 z-[99999] rounded-lg bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-4 text-white shadow-2xl",t.innerHTML=`
                        <div class="flex items-center gap-3">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <div>
                                <div class="font-bold">âœ… Restored Successfully!</div>
                                <div class="text-sm opacity-90">Reloading page...</div>
                            </div>
                        </div>
                    `,document.body.appendChild(t),setTimeout(()=>{window.location.href=window.location.href.split("?")[0]+"?t="+Date.now()},800)},onError:t=>{console.error("Restore failed:",t),alert("Failed to restore: "+(t.message||"Unknown error")),g(null)}})}catch(t){console.error("Restore error:",t),alert("Failed to restore revision"),g(null)}}},$=s=>{switch(s){case"text_update":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"image_upload":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"restore":return"bg-green-500/20 text-green-400 border-green-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},j=s=>{switch(s){case"text_update":return e.jsx(_,{className:"h-3 w-3"});case"image_upload":return e.jsx(S,{className:"h-3 w-3"});case"restore":return e.jsx(C,{className:"h-3 w-3"});default:return e.jsx(p,{className:"h-3 w-3"})}};return e.jsxs(E,{children:[e.jsx(L,{title:"Admin History Management"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>k.visit("/home"),className:"mb-4 flex items-center gap-2 text-gray-400 transition-colors hover:text-white",children:[e.jsx(P,{className:"h-4 w-4"}),"Back to Home"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center gap-3 text-4xl font-bold text-white",children:[e.jsx(p,{className:"h-8 w-8 text-blue-400"}),"History Management"]}),e.jsx("p",{className:"mt-2 text-gray-400",children:"View and restore all content changes across your website"})]}),e.jsxs("div",{className:"rounded-lg bg-blue-500/10 px-4 py-2 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:x.length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total Sections"})]})]})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(U,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by page, section, or field...",value:i,onChange:s=>R(s.target.value),className:"w-full rounded-lg border border-gray-700 bg-gray-800/50 py-3 pl-10 pr-4 text-white placeholder-gray-500 backdrop-blur-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>m("all"),className:`flex items-center gap-2 rounded-lg px-4 py-3 transition-all ${l==="all"?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"}`,children:[e.jsx(D,{className:"h-4 w-4"}),"All"]}),e.jsxs("button",{onClick:()=>m("text"),className:`flex items-center gap-2 rounded-lg px-4 py-3 transition-all ${l==="text"?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"}`,children:[e.jsx(_,{className:"h-4 w-4"}),"Text"]}),e.jsxs("button",{onClick:()=>m("image"),className:`flex items-center gap-2 rounded-lg px-4 py-3 transition-all ${l==="image"?"bg-blue-500 text-white":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"}`,children:[e.jsx(S,{className:"h-4 w-4"}),"Images"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[Object.entries(b).map(([s,a])=>e.jsxs("div",{className:"rounded-xl border border-gray-700/50 bg-gray-800/30 p-6 backdrop-blur-sm",children:[e.jsxs("h2",{className:"mb-4 text-2xl font-bold text-white",children:[s," Page",e.jsxs("span",{className:"ml-3 text-sm font-normal text-gray-400",children:["(",a.length," sections)"]})]}),e.jsx("div",{className:"space-y-3",children:a.map(t=>{const{section:o,field:c,fullPath:d}=h(t.key),N=T.has(t.key);return e.jsxs("div",{className:"rounded-lg border border-gray-700/50 bg-gray-900/50 transition-all hover:border-gray-600",children:[e.jsxs("button",{onClick:()=>A(t.key),className:"flex w-full items-center justify-between p-4 text-left transition-colors hover:bg-gray-800/30",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-semibold text-white",children:[o," - ",c]}),t.current_image&&e.jsx("span",{className:"rounded-full bg-purple-500/20 px-2 py-0.5 text-xs text-purple-400",children:"Has Image"}),t.current_content&&e.jsx("span",{className:"rounded-full bg-blue-500/20 px-2 py-0.5 text-xs text-blue-400",children:"Has Text"})]}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:d}),t.revisions.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:[t.total_revisions," revision",t.total_revisions!==1?"s":""," available"]})]}),N?e.jsx(B,{className:"h-5 w-5 text-gray-400"}):e.jsx(I,{className:"h-5 w-5 text-gray-400"})]}),e.jsx(F,{children:N&&e.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden border-t border-gray-700/50",children:e.jsx("div",{className:"space-y-3 p-4",children:t.revisions.length===0?e.jsx("div",{className:"py-8 text-center text-gray-500",children:"No revision history available"}):t.revisions.map((r,v)=>e.jsxs(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:v*.05},className:"flex items-start gap-4 rounded-lg border border-gray-700/30 bg-gray-800/30 p-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-500/20",children:j(r.change_type)}),v<t.revisions.length-1&&e.jsx("div",{className:"h-full w-px bg-gray-700/50"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-xs font-medium ${$(r.change_type)}`,children:[j(r.change_type),r.change_type.replace("_"," ")]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(z,{className:"h-3 w-3"}),r.created_at_human]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(V,{className:"h-3 w-3"}),r.changed_by]})]})}),e.jsx("button",{onClick:()=>M(t.key,r.id),disabled:y===r.id,className:"flex items-center gap-2 rounded-lg bg-green-500/20 px-3 py-1.5 text-sm font-medium text-green-400 transition-all hover:bg-green-500/30 disabled:opacity-50",children:y===r.id?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Restoring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"h-4 w-4"}),"Restore"]})})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[r.image&&e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-700/50",children:e.jsx("img",{src:r.image,alt:"Revision preview",className:"h-32 w-full object-cover"})}),r.content&&e.jsx("div",{className:"rounded-lg border border-gray-700/50 bg-gray-900/50 p-3 text-sm text-gray-300",children:r.content})]})]})]},r.id))})})})]},t.key)})})]},s)),Object.keys(b).length===0&&e.jsxs("div",{className:"rounded-xl border border-gray-700/50 bg-gray-800/30 p-12 text-center backdrop-blur-sm",children:[e.jsx(p,{className:"mx-auto h-16 w-16 text-gray-600"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-white",children:"No History Found"}),e.jsx("p",{className:"mt-2 text-gray-400",children:i||l!=="all"?"Try adjusting your filters":"No content changes have been made yet"})]})]})]})})]})}export{re as default};
