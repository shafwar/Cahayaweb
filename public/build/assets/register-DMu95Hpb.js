import{j as e,L as u,I as x,B as k}from"./app-DZ42qzUO.js";import{d as E,u as L,H as F}from"./inertia-DFKzB8kt.js";import{T as C}from"./text-link-C2O1fR0m.js";import{I as h}from"./input-B_viOCZL.js";import{A as _,L as T}from"./auth-layout-BY7z7Jz8.js";/* empty css            */import"./vendor-DP3lGzMr.js";function M(){const{url:b,props:P}=E(),j=new URLSearchParams(b.split("?")[1]||"").get("mode"),v=new URLSearchParams(b.split("?")[1]||"").get("redirect"),N=P?.status,{data:r,setData:n,post:I,processing:o,errors:s,reset:R}=L({name:"",email:"",password:"",password_confirmation:""}),S=t=>{t.preventDefault();let i=document.querySelector('meta[name="csrf-token"]')?.content;if(!i&&typeof document<"u"){const a=document.cookie.split("; ").find(d=>d.startsWith("XSRF-TOKEN="));a&&(i=decodeURIComponent(a.split("=")[1]))}i&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=i);const y=new URLSearchParams(window.location.search),l=y.get("mode"),c=y.get("redirect");let m=route("register");const p=new URLSearchParams;if(l&&p.set("mode",l),c&&p.set("redirect",c),p.toString()&&(m+="?"+p.toString()),typeof window<"u"&&window.location.protocol==="https:"){const a=new URL(m,window.location.origin);a.protocol==="http:"&&(a.protocol="https:",m=a.toString())}const g={...r};l&&(g.mode=l),c&&(g.redirect=c),I(m,{data:g,preserveState:!1,preserveScroll:!1,only:[],onError:a=>{console.error("Registration errors:",a);const d=a?.message||(typeof a=="string"?a:"");if(d.includes("419")||d.includes("expired")||d.includes("PAGE EXPIRED")){alert("Your session has expired. Please refresh the page and try again."),window.location.reload();return}const f=Object.keys(a)[0];if(f){const w=document.getElementById(f)||document.querySelector(`[name="${f}"]`);w&&(w.scrollIntoView({behavior:"smooth",block:"center"}),w.focus())}},onSuccess:()=>{},onFinish:()=>{R("password","password_confirmation")}})};return e.jsxs(_,{title:"Create an account",description:"Enter your details below to create your account",children:[e.jsx(F,{title:"Register"}),N&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-500/30 bg-green-500/10 p-3",children:e.jsx("p",{className:"text-sm text-green-300",children:N})}),e.jsxs("form",{method:"POST",className:"flex flex-col gap-6",onSubmit:S,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"name",children:"Name"}),e.jsx(h,{id:"name",type:"text",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"name",value:r.name,onChange:t=>n("name",t.target.value),disabled:o,placeholder:"Full name"}),e.jsx(x,{message:s.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"email",children:"Email address"}),e.jsx(h,{id:"email",type:"email",required:!0,tabIndex:2,autoComplete:"email",value:r.email,onChange:t=>n("email",t.target.value),disabled:o,placeholder:"email@example.com",className:s.email&&s.email.includes("already registered")?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),e.jsx(x,{message:s.email}),s.email&&(s.email.includes("already registered")||s.email.includes("already been taken")||s.email.includes("unique"))&&e.jsx("div",{className:"mt-2 rounded-lg border-2 border-amber-500/50 bg-amber-500/20 p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"mb-1 text-sm font-semibold text-amber-300",children:"Email Already Registered"}),e.jsxs("p",{className:"text-sm leading-relaxed text-amber-200/90",children:["The email address ",e.jsx("strong",{className:"font-semibold text-amber-100",children:r.email})," is already registered in our system."]}),e.jsxs("p",{className:"mt-2 text-sm text-amber-200/90",children:["If this is your account, please"," ",e.jsx(C,{href:route("login",j==="b2b"?{mode:"b2b",redirect:v}:{}),className:"font-semibold text-amber-100 underline hover:text-amber-50",children:"log in here"})," ","instead. If you forgot your password, you can reset it from the login page."]})]})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsx(h,{id:"password",type:"password",required:!0,tabIndex:3,autoComplete:"new-password",value:r.password,onChange:t=>n("password",t.target.value),disabled:o,placeholder:"Password (minimum 8 characters)",minLength:8}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{message:s.password}),!s.password&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters long."})]}),r.password&&r.password.length>0&&r.password.length<8&&e.jsx("div",{className:"mt-1 rounded-lg border border-amber-500/30 bg-amber-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-amber-300",children:[e.jsx("strong",{children:"Password too short:"})," Your password must be at least 8 characters. Currently: ",r.password.length," character",r.password.length!==1?"s":"","."]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(h,{id:"password_confirmation",type:"password",required:!0,tabIndex:4,autoComplete:"new-password",value:r.password_confirmation,onChange:t=>n("password_confirmation",t.target.value),disabled:o,placeholder:"Confirm password"}),e.jsx(x,{message:s.password_confirmation}),r.password&&r.password_confirmation&&r.password!==r.password_confirmation&&e.jsx("div",{className:"mt-1 rounded-lg border border-red-500/30 bg-red-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-red-300",children:[e.jsx("strong",{children:"Passwords do not match."})," Please make sure both password fields contain the same password."]})})]}),e.jsx(k,{type:"submit",className:"mt-2 w-full",tabIndex:5,disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create account"})]}),s&&Object.keys(s).length>0&&!s.name&&!s.email&&!s.password&&!s.password_confirmation&&e.jsx("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsx("p",{className:"text-sm text-red-300",children:"Please check the form for errors and try again."})}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(C,{href:route("login",j==="b2b"?{mode:"b2b",redirect:v}:{}),tabIndex:6,children:"Log in"})]})]})]})}export{M as default};
