import{j as e}from"./framer-motion-D9Ds6MjR.js";import{u as T,r as I,d as q,H as A}from"./inertia-D2QVZ4Tm.js";import{L as h,I as x}from"./label-wPYqOWKG.js";import{T as R}from"./text-link-CmZDO7bg.js";import{B}from"./button-oPW4PEgM.js";import{I as g}from"./input-C3W3VNEz.js";import{A as O}from"./auth-layout-BZIaEmMW.js";import{Q as z}from"./lucide-CmpPQWiQ.js";import"./vendor-DP3lGzMr.js";import"./app-_9UPXpHY.js";/* empty css            */import"./radix-ui-CoelwvIk.js";function Z(){const{url:l,props:E}=T(),j=E?.status,[y,v]=I.useState(!1),{data:r,setData:i,post:k,processing:N,errors:s,reset:F}=q({name:"",email:"",password:"",password_confirmation:"",mode:"",redirect:""});I.useEffect(()=>{const a=new URLSearchParams(typeof window<"u"?window.location.search:l.split("?")[1]||""),c=a.get("mode"),o=a.get("redirect");(c||o)&&i(m=>({...m,...c?{mode:c}:{},...o?{redirect:o}:{}}))},[l]);const f=new URLSearchParams(l.split("?")[1]||"").get("mode"),S=new URLSearchParams(l.split("?")[1]||"").get("redirect"),L=a=>{if(a.preventDefault(),N||y)return;v(!0);let o=document.querySelector('meta[name="csrf-token"]')?.content;if(!o&&typeof document<"u"){const t=document.cookie.split("; ").find(n=>n.startsWith("XSRF-TOKEN="));t&&(o=decodeURIComponent(t.split("=")[1]))}o&&typeof window<"u"&&window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=o);const m=new URLSearchParams(typeof window<"u"?window.location.search:""),U=m.get("mode"),_=m.get("redirect"),P=r.mode||U,C=r.redirect||_;let p=route("register");const u=new URLSearchParams;if(P&&u.set("mode",P),C&&u.set("redirect",C),u.toString()&&(p+="?"+u.toString()),typeof window<"u"&&window.location.protocol==="https:"){const t=new URL(p,window.location.origin);t.protocol==="http:"&&(t.protocol="https:",p=t.toString())}k(p,{preserveState:!1,preserveScroll:!1,only:[],onError:t=>{console.error("Registration errors:",t);const n=t?.message||(typeof t=="string"?t:"");if(n.includes("419")||n.includes("expired")||n.includes("PAGE EXPIRED")){alert("Your session has expired. Please refresh the page and try again."),window.location.reload();return}const b=Object.keys(t)[0];if(b){const w=document.getElementById(b)||document.querySelector(`[name="${b}"]`);w&&(w.scrollIntoView({behavior:"smooth",block:"center"}),w.focus())}},onFinish:()=>{v(!1),F("password","password_confirmation")}})},d=y||N;return e.jsxs(O,{title:"Create an account",description:"Enter your details below to create your account",children:[e.jsx(A,{title:"Register"}),j&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-500/30 bg-green-500/10 p-3",children:e.jsx("p",{className:"text-sm text-green-300",children:j})}),f==="b2b"&&e.jsx("div",{className:"mb-4 rounded-lg border border-blue-500/30 bg-blue-500/10 p-3",children:e.jsx("p",{className:"text-sm text-blue-200",children:"After creating your account you will be redirected to the verification page to complete your B2B application."})}),e.jsxs("form",{method:"POST",className:"flex flex-col gap-6",onSubmit:L,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"name",children:"Name"}),e.jsx(g,{id:"name",type:"text",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"name",value:r.name,onChange:a=>i("name",a.target.value),disabled:d,placeholder:"Full name"}),e.jsx(x,{message:s.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"email",children:"Email address"}),e.jsx(g,{id:"email",type:"email",required:!0,tabIndex:2,autoComplete:"email",value:r.email,onChange:a=>i("email",a.target.value),disabled:d,placeholder:"email@example.com",className:s.email&&s.email.includes("already registered")?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),e.jsx(x,{message:s.email}),s.email&&(s.email.includes("already registered")||s.email.includes("already been taken")||s.email.includes("unique"))&&e.jsx("div",{className:"mt-2 rounded-lg border-2 border-amber-500/50 bg-amber-500/20 p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"mb-1 text-sm font-semibold text-amber-300",children:"Email Already Registered"}),e.jsxs("p",{className:"text-sm leading-relaxed text-amber-200/90",children:["The email address ",e.jsx("strong",{className:"font-semibold text-amber-100",children:r.email})," is already registered in our system."]}),e.jsxs("p",{className:"mt-2 text-sm text-amber-200/90",children:["If this is your account, please"," ",e.jsx(R,{href:route("login",f==="b2b"?{mode:"b2b",redirect:S}:{}),className:"font-semibold text-amber-100 underline hover:text-amber-50",children:"log in here"})," ","instead. If you forgot your password, you can reset it from the login page."]})]})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(g,{id:"password",type:"password",required:!0,tabIndex:3,autoComplete:"new-password",value:r.password,onChange:a=>i("password",a.target.value),disabled:d,placeholder:"Password (minimum 8 characters)",minLength:8}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(x,{message:s.password}),!s.password&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters long."})]}),r.password&&r.password.length>0&&r.password.length<8&&e.jsx("div",{className:"mt-1 rounded-lg border border-amber-500/30 bg-amber-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-amber-300",children:[e.jsx("strong",{children:"Password too short:"})," Your password must be at least 8 characters. Currently:"," ",r.password.length," character",r.password.length!==1?"s":"","."]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(g,{id:"password_confirmation",type:"password",required:!0,tabIndex:4,autoComplete:"new-password",value:r.password_confirmation,onChange:a=>i("password_confirmation",a.target.value),disabled:d,placeholder:"Confirm password"}),e.jsx(x,{message:s.password_confirmation}),r.password&&r.password_confirmation&&r.password!==r.password_confirmation&&e.jsx("div",{className:"mt-1 rounded-lg border border-red-500/30 bg-red-500/10 p-2",children:e.jsxs("p",{className:"text-xs text-red-300",children:[e.jsx("strong",{children:"Passwords do not match."})," Please make sure both password fields contain the same password."]})})]}),e.jsx(B,{type:"submit",className:"mt-2 w-full",tabIndex:5,disabled:d,"aria-busy":d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 shrink-0 animate-spin","aria-hidden":!0}),"Creating account..."]}):"Create account"})]}),s&&Object.keys(s).length>0&&!s.name&&!s.email&&!s.password&&!s.password_confirmation&&e.jsx("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:e.jsx("p",{className:"text-sm text-red-300",children:"Please check the form for errors and try again."})}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(R,{href:route("login",f==="b2b"?{mode:"b2b",redirect:S}:{}),tabIndex:6,children:"Log in"})]})]})]})}export{Z as default};
