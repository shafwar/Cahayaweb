import{j as a,A as D,m as S}from"./framer-motion-D9Ds6MjR.js";import{u as H,r,a as K,b as W,H as z}from"./inertia-D2QVZ4Tm.js";import{n as B,j as G,I as _,h as q,P as J,E as c}from"./app-BYUxPJCE.js";import"./vendor-DP3lGzMr.js";/* empty css            */import"./radix-ui-p1SN9qEY.js";import"./lucide-BqQJBEkW.js";function Q({sectionKey:l,src:i,alt:R,className:E,imgClassName:I,aspect:M=16/9}){const{isAdmin:d,editMode:m,markDirty:b}=B(),{props:x}=H(),f=x.cmsMediaGuide?.images??{},y=x.sections?.[l]?.image,[O,U]=r.useState(void 0),[A,h]=r.useState(!1),[L,j]=r.useState(!1),[n,p]=r.useState(null),v=r.useRef(null),C=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:q(e):"",F=O??(y?C(y):i?C(i):""),k=r.useCallback(async e=>{const s=new File([e],"image.jpg",{type:e.type}),o=await G(s),t=new FormData;t.append("key",l),t.append("image",o),await K.post("/admin/upload-image",t,{headers:{Accept:"application/json"}}),h(!0),setTimeout(()=>h(!1),900),U(void 0),W.reload({only:["sections"],onSuccess:()=>{console.log("✅ Image reloaded from database:",l)}})},[l]),N=r.useCallback(e=>{const s=URL.createObjectURL(e);p(s),j(!0),b()},[b]),T=r.useCallback(async e=>{if(n)try{await k(e),URL.revokeObjectURL(n),p(null)}catch(s){console.error("Failed to upload image:",s);const t=(s&&typeof s=="object"&&"response"in s?s:null)?.response?.data;let g=t?.message||(s instanceof Error?s.message:"Failed to upload image");if(t?.errors&&typeof t.errors=="object"){const w=Object.values(t.errors).flat().filter(Boolean);w.length&&(g=w.join(". "))}alert(g)}},[n,k]),P=r.useCallback(()=>{n&&(URL.revokeObjectURL(n),p(null))},[n]),u=r.useCallback(e=>{e.type.startsWith("image/")&&N(e)},[N]),$=r.useCallback(e=>{const s=e.target.files?.[0];s&&u(s),e.target.value=""},[u]);return a.jsxs("div",{className:`group relative ${E??""}`,onDragOver:e=>m&&d?(e.preventDefault(),e.dataTransfer.dropEffect="copy"):void 0,onDrop:e=>{if(!(m&&d))return;e.preventDefault();const s=e.dataTransfer.files?.[0];s&&u(s)},children:[a.jsx("img",{src:F,alt:R,className:I,onError:e=>{const s=e.currentTarget;if(s.src&&s.src.includes("assets.cahayaanbiya.com")){const o=s.src;let t=o;o.includes("/public/images/")?t=o.replace("/public/images/","/images/"):o.includes("/public/")?t=o.replace("/public/","/"):o.includes("/images/")?t=o.replace("/images/","/public/images/"):t=`https://assets.cahayaanbiya.com/public/images/${o.split("/").pop()||i||""}`,console.log("[EditableImage] Trying alternative R2 path:",t),s.src=t}}}),a.jsx(D,{children:d&&m&&a.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-[9999] flex flex-col items-center justify-center gap-3 rounded-md bg-black/70 backdrop-blur-md",onClick:()=>v.current?.click(),style:{pointerEvents:"auto"},children:[a.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-xl border-2 border-blue-400/50 bg-black/90 p-6 shadow-2xl backdrop-blur-sm",children:[a.jsx("span",{className:"rounded-lg bg-white px-5 py-2.5 text-sm font-bold text-gray-900 shadow-lg",children:"Drag & Drop atau Klik untuk ganti gambar"}),a.jsx("span",{className:"text-xs text-neutral-300",children:"Anda bisa atur posisi gambar sebelum disimpan"}),f.short&&a.jsx("span",{className:"rounded-lg border-2 border-amber-400 bg-gradient-to-r from-amber-900 to-orange-900 px-5 py-2.5 text-xs font-bold text-amber-50 shadow-lg",children:f.short})]}),a.jsx("input",{ref:v,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:$})]})}),a.jsx(D,{children:A&&a.jsx(S.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"absolute -bottom-6 left-0 z-50 rounded bg-black/80 px-2 py-1 text-xs text-emerald-300",children:"Image saved ✓"})}),n&&a.jsx(_,{open:L,onOpenChange:j,imageSrc:n,aspect:M,onApply:T,onCancel:P})]})}function te(){const l=[{id:1,name:"Arab Saudi",description:"Spiritual journey to the Holy Land",image:"/arabsaudi.jpg"},{id:2,name:"Dubai",description:"Modern wonders & desert adventures",image:"/dubai1.jpeg"}];return a.jsxs(J,{children:[a.jsx(z,{title:"CMS Demo Destinations"}),a.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-10",children:[a.jsx(c,{sectionKey:"cms.demo.title",value:"CMS Demo Destinations",tag:"h1",className:"text-3xl font-bold"}),a.jsx("p",{className:"mt-2 text-gray-500",children:a.jsx(c,{sectionKey:"cms.demo.subtitle",value:"Try editing texts and replacing images inline. Only admins see the controls.",tag:"span"})}),a.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2",children:l.map(i=>a.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/50",children:[a.jsx(Q,{sectionKey:`cms.demo.dest.${i.id}.image`,src:i.image,alt:i.name,imgClassName:"h-56 w-full object-cover"}),a.jsxs("div",{className:"p-4",children:[a.jsx(c,{sectionKey:`cms.demo.dest.${i.id}.name`,value:i.name,tag:"h3",className:"text-lg font-semibold text-white"}),a.jsx(c,{sectionKey:`cms.demo.dest.${i.id}.desc`,value:i.description,tag:"p",className:"mt-1 text-sm text-gray-300"})]})]},i.id))})]})]})}export{te as default};
