import{j as e,A as D,m as k}from"./framer-motion-D9Ds6MjR.js";import{u as T,r as l,a as I,b as M,H as O}from"./inertia-D2QVZ4Tm.js";import{f as A,a as F,g as $,P as H,E as d}from"./app-D0SM7HRd.js";import"./vendor-DP3lGzMr.js";/* empty css            */import"./lucide-BqQJBEkW.js";import"./radix-ui-CoelwvIk.js";function z({sectionKey:n,src:t,alt:R,className:E,imgClassName:C}){const{isAdmin:m,editMode:p,markDirty:x}=A(),{props:b}=T(),f=b.cmsMediaGuide?.images??{},h=b.sections?.[n]?.image,[S,g]=l.useState(void 0),[U,y]=l.useState(!1),j=l.useRef(null),v=a=>a?a.startsWith("http://")||a.startsWith("https://")?a:$(a):"",L=S??(h?v(h):t?v(t):""),u=l.useCallback(async a=>{const s=URL.createObjectURL(a);g(s),x();const i=await F(a),o=new FormData;o.append("key",n),o.append("image",i);try{await I.post("/admin/upload-image",o,{headers:{Accept:"application/json"}}),y(!0),setTimeout(()=>y(!1),900),URL.revokeObjectURL(s),g(void 0),M.reload({only:["sections"],onSuccess:()=>{console.log("✅ Image reloaded from database:",n)}})}catch(r){console.error("Failed to upload image:",r);const c=(r&&typeof r=="object"&&"response"in r?r:null)?.response?.data;let N=c?.message||(r instanceof Error?r.message:"Failed to upload image");if(c?.errors&&typeof c.errors=="object"){const w=Object.values(c.errors).flat().filter(Boolean);w.length&&(N=w.join(". "))}alert(N),URL.revokeObjectURL(s),g(void 0)}},[n,x]),P=l.useCallback(a=>{const s=a.target.files?.[0];s&&u(s)},[u]);return e.jsxs("div",{className:`group relative ${E??""}`,onDragOver:a=>p&&m?(a.preventDefault(),a.dataTransfer.dropEffect="copy"):void 0,onDrop:a=>{if(!(p&&m))return;a.preventDefault();const s=a.dataTransfer.files?.[0];s&&u(s)},children:[e.jsx("img",{src:L,alt:R,className:C,onError:a=>{const s=a.currentTarget;if(s.src&&s.src.includes("assets.cahayaanbiya.com")){const i=s.src;let o=i;i.includes("/public/images/")?o=i.replace("/public/images/","/images/"):i.includes("/public/")?o=i.replace("/public/","/"):i.includes("/images/")?o=i.replace("/images/","/public/images/"):o=`https://assets.cahayaanbiya.com/public/images/${i.split("/").pop()||t||""}`,console.log("[EditableImage] Trying alternative R2 path:",o),s.src=o}}}),e.jsx(D,{children:m&&p&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-[9999] flex flex-col items-center justify-center gap-3 rounded-md bg-black/70 backdrop-blur-md",onClick:()=>j.current?.click(),style:{pointerEvents:"auto"},children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-xl border-2 border-blue-400/50 bg-black/90 p-6 shadow-2xl backdrop-blur-sm",children:[e.jsx("span",{className:"rounded-lg bg-white px-5 py-2.5 text-sm font-bold text-gray-900 shadow-lg",children:"Drag & Drop image or Click to replace"}),f.short&&e.jsx("span",{className:"rounded-lg border-2 border-amber-400 bg-gradient-to-r from-amber-900 to-orange-900 px-5 py-2.5 text-xs font-bold text-amber-50 shadow-lg",children:f.short})]}),e.jsx("input",{ref:j,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:P})]})}),e.jsx(D,{children:U&&e.jsx(k.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},className:"absolute -bottom-6 left-0 z-50 rounded bg-black/80 px-2 py-1 text-xs text-emerald-300",children:"Image saved ✓"})})]})}function V(){const n=[{id:1,name:"Arab Saudi",description:"Spiritual journey to the Holy Land",image:"/arabsaudi.jpg"},{id:2,name:"Dubai",description:"Modern wonders & desert adventures",image:"/dubai1.jpeg"}];return e.jsxs(H,{children:[e.jsx(O,{title:"CMS Demo Destinations"}),e.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-10",children:[e.jsx(d,{sectionKey:"cms.demo.title",value:"CMS Demo Destinations",tag:"h1",className:"text-3xl font-bold"}),e.jsx("p",{className:"mt-2 text-gray-500",children:e.jsx(d,{sectionKey:"cms.demo.subtitle",value:"Try editing texts and replacing images inline. Only admins see the controls.",tag:"span"})}),e.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2",children:n.map(t=>e.jsxs("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/50",children:[e.jsx(z,{sectionKey:`cms.demo.dest.${t.id}.image`,src:t.image,alt:t.name,imgClassName:"h-56 w-full object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx(d,{sectionKey:`cms.demo.dest.${t.id}.name`,value:t.name,tag:"h3",className:"text-lg font-semibold text-white"}),e.jsx(d,{sectionKey:`cms.demo.dest.${t.id}.desc`,value:t.description,tag:"p",className:"mt-1 text-sm text-gray-300"})]})]},t.id))})]})]})}export{V as default};
